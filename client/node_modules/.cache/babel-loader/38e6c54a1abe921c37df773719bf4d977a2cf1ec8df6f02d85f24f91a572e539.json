{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"D:\\\\IntPrep\\\\client\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useState, useEffect } from \"react\";\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from \"firebase/auth\";\nimport { auth } from \"../config/firebase\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function useAuth() {\n  _s();\n  return useContext(AuthContext);\n}\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport function AuthProvider({\n  children\n}) {\n  _s2();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // Set up axios interceptor for auth token\n  useEffect(() => {\n    const interceptor = axios.interceptors.request.use(async config => {\n      if (currentUser) {\n        const token = await currentUser.getIdToken();\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n      return config;\n    }, error => {\n      return Promise.reject(error);\n    });\n    return () => axios.interceptors.request.eject(interceptor);\n  }, [currentUser]);\n  function signup(email, password, displayName) {\n    return createUserWithEmailAndPassword(auth, email, password).then(async result => {\n      await updateProfile(result.user, {\n        displayName\n      });\n      return result;\n    });\n  }\n  function login(email, password) {\n    return signInWithEmailAndPassword(auth, email, password);\n  }\n  function logout() {\n    return signOut(auth);\n  }\n\n  // Create or update user profile in backend\n  async function syncUserProfile(user) {\n    try {\n      const token = await user.getIdToken();\n      await axios.post(\"/api/auth/profile\", {}, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n    } catch (error) {\n      console.error(\"Failed to sync user profile:\", error);\n    }\n  }\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async user => {\n      setCurrentUser(user);\n      if (user) {\n        await syncUserProfile(user);\n      }\n      setLoading(false);\n    });\n    return unsubscribe;\n  }, []);\n  const value = {\n    currentUser,\n    signup,\n    login,\n    logout,\n    loading\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: !loading && children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 10\n  }, this);\n}\n_s2(AuthProvider, \"glPFyssxmgyFBfEUyUTyfs2Yb0g=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","_s2","createContext","useContext","useState","useEffect","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","updateProfile","auth","axios","jsxDEV","_jsxDEV","AuthContext","useAuth","AuthProvider","children","currentUser","setCurrentUser","loading","setLoading","interceptor","interceptors","request","use","config","token","getIdToken","headers","Authorization","error","Promise","reject","eject","signup","email","password","displayName","then","result","user","login","logout","syncUserProfile","post","console","unsubscribe","value","Provider","fileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/IntPrep/client/src/contexts/AuthContext.js"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useState, useEffect } from \"react\"\nimport {\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  signOut,\n  onAuthStateChanged,\n  updateProfile,\n} from \"firebase/auth\"\nimport { auth } from \"../config/firebase\"\nimport axios from \"axios\"\n\nconst AuthContext = createContext()\n\nexport function useAuth() {\n  return useContext(AuthContext)\n}\n\nexport function AuthProvider({ children }) {\n  const [currentUser, setCurrentUser] = useState(null)\n  const [loading, setLoading] = useState(true)\n\n  // Set up axios interceptor for auth token\n  useEffect(() => {\n    const interceptor = axios.interceptors.request.use(\n      async (config) => {\n        if (currentUser) {\n          const token = await currentUser.getIdToken()\n          config.headers.Authorization = `Bearer ${token}`\n        }\n        return config\n      },\n      (error) => {\n        return Promise.reject(error)\n      },\n    )\n\n    return () => axios.interceptors.request.eject(interceptor)\n  }, [currentUser])\n\n  function signup(email, password, displayName) {\n    return createUserWithEmailAndPassword(auth, email, password).then(async (result) => {\n      await updateProfile(result.user, { displayName })\n      return result\n    })\n  }\n\n  function login(email, password) {\n    return signInWithEmailAndPassword(auth, email, password)\n  }\n\n  function logout() {\n    return signOut(auth)\n  }\n\n  // Create or update user profile in backend\n  async function syncUserProfile(user) {\n    try {\n      const token = await user.getIdToken()\n      await axios.post(\n        \"/api/auth/profile\",\n        {},\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        },\n      )\n    } catch (error) {\n      console.error(\"Failed to sync user profile:\", error)\n    }\n  }\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      setCurrentUser(user)\n      if (user) {\n        await syncUserProfile(user)\n      }\n      setLoading(false)\n    })\n\n    return unsubscribe\n  }, [])\n\n  const value = {\n    currentUser,\n    signup,\n    login,\n    logout,\n    loading,\n  }\n\n  return <AuthContext.Provider value={value}>{!loading && children}</AuthContext.Provider>\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}